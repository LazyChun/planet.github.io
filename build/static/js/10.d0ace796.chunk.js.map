{"version":3,"sources":["components/pages/program/programSegaments/Description.js","components/pages/program/programSegaments/Header.js","components/pages/program/programSegaments/ProgramEmpty.js","components/pages/program/programSegaments/JsProgram.js","components/pages/program/programSegaments/HtmlProgram.js","components/pages/program/programSegaments/ProgramWindow.js","components/common/ReportAction.js","components/common/RatingAction.js","components/common/GitAction.js","components/common/HelpAction.js","components/common/FloatActions.js","components/common/ServerStore.js","components/pages/program/programSegaments/HelpPanel.js","components/pages/program/Program.js","components/common/Styles.js","components/common/CurrentObjLoader.js"],"names":["Container","styled","div","Content","Description","descriptionUrl","useState","description","setDescription","useEffect","onUpdateValue","str","getDataFromUrl","dangerouslySetInnerHTML","__html","Name","InfoBox","InfoItemBox","ItemText","TestHint","span","InfoItem","icon","iconStyle","text","hintText","content","Icon","style","name","Popup","trigger","Header","id","lastUpdated","upCount","readCount","followerCount","currentUpped","totalUsedCount","currentFollowed","refetchProgram","programVersion","status","versionCode","ClickWrapper","gql","SWITCH_FOLLOW","variables","objId","objType","OBJ_TYPES","PROGRAM","onCompleted","color","SWITCH_UP","Space","width","Number","HintText","ProgramEmpty","props","height","IFrame","iframe","JsProgram","code","programUrl","programId","programName","currentUser","versionId","importType","loading","useIframeLoading","useResizeIframe","currentUserStr","JSON","stringify","_pick","avatar","_get","Loading","hasMask","src","SERVER_URL","access_token","encodeURIComponent","HtmlProgram","ProgramWindow","program","currentVersion","programComponent","getProgramByImportType","codeFile","url","MAIN_RED","ReportAction","type","title","currentReport","reportCallback","ReportButton","size","Btn","Tooltip","RatingScore","RatingBox","RatingAction","averageScore","currentRating","onRateCompleted","useRating","rating","onRate","mLoading","toFixed","className","Rating","e","maxRating","GitIcon","img","GitBox","GitItemBox","GitLink","a","TypeNameBox","GitItem","linkUrl","typeName","href","target","GitAction","gitLinks","_map","g","key","gitType","HelpAction","onShowSwitch","onClick","FloatActions","reportProps","ratingProps","helpProps","helpVideo","helpDescription","gitProps","_isEmpty","STORE_TYPES","useServerStore","useQuery","GET_PROGRAM_DATA_LIST","skip","error","data","refetch","useMutation","SAVE_PROGRAM_DATA","onError","saveData","programCode","serverStore","isLarge","isOpened","Promise","resolve","reject","params","dataText","uniqueId","then","res","console","log","window","ServerStore","children","VideoBox","HelpPanel","Video","contentUrl","isContent","ProgramBox","_Program","useRead","PageTitle","metaKeywords","CurrentObjLoader","openedObj","Comments","getQueryGql","version","GET_PROGRAM_WITH_VERSION","GET_PROGRAM","HelpTitle","Program","history","location","useParams","showHelp","setShowHelp","autoLoading","item","placement","closable","onClose","visible","getContainer","position","_CurrentObjLoader","setOpenedObj","Consumer","onGoTo"],"mappings":"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","file":"static/js/10.d0ace796.chunk.js","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport styled from \"styled-components\";\r\nimport { getDataFromUrl } from \"../../../utils/urlData\";\r\n\r\nconst Container = styled.div`\r\n  margin-top: 20px;\r\n  text-align: left;\r\n  margin-bottom: 20px;\r\n  overflow-y: hidden;\r\n`;\r\nconst Content = styled.div`\r\n  margin-top: 20px;\r\n  font-size: 14px;\r\n  color: #262626;\r\n`;\r\n\r\nconst Description = ({ descriptionUrl }) => {\r\n  const [description, setDescription] = useState(\"\");\r\n\r\n  useEffect(() => {\r\n    let onUpdateValue = str => setDescription(str);\r\n    getDataFromUrl(descriptionUrl, \"data.content\", onUpdateValue);\r\n    return () => {\r\n      onUpdateValue = null;\r\n    };\r\n  }, []);\r\n  return (\r\n    <Container>\r\n      <Content dangerouslySetInnerHTML={{ __html: description }} />\r\n    </Container>\r\n  );\r\n};\r\n\r\nexport default Description;\r\n","import React, { useState, useEffect } from \"react\";\r\nimport styled from \"styled-components\";\r\nimport { Dimmer, Loader, Image, Icon, Popup } from \"semantic-ui-react\";\r\nimport ClickWrapper from \"../../ClickWrapper\";\r\nimport { SWITCH_FOLLOW, SWITCH_UP } from \"../../../common/mutationGql\";\r\nimport { OBJ_TYPES } from \"../../../common/CONSULT\";\r\nimport Space from \"../../../common/Space\";\r\n\r\nconst Container = styled.div`\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  width: 100%;\r\n  background-color: #f2f2f2;\r\n  padding: 12px;\r\n  margin-bottom: 16px;\r\n`;\r\n\r\nconst Name = styled.div`\r\n  color: #333333;\r\n  font-size: 20px;\r\n  font-weight: bold;\r\n`;\r\n\r\nconst InfoBox = styled.div`\r\n  display: flex;\r\n`;\r\n\r\nconst InfoItemBox = styled.div`\r\n  display: flex;\r\n  margin-left: 20px;\r\n  cursor: pointer;\r\n`;\r\n\r\nconst ItemText = styled.div``;\r\n\r\nconst TestHint = styled.span`\r\n  color: indianred;\r\n  font-weight: 500;\r\n  margin-left: 10px;\r\n`;\r\n\r\nconst InfoItem = ({ icon, iconStyle, text, hintText }) => {\r\n  const content = (\r\n    <InfoItemBox>\r\n      <Icon style={iconStyle} name={icon} />\r\n      <ItemText>{text}</ItemText>\r\n    </InfoItemBox>\r\n  );\r\n  return hintText ? <Popup content={hintText} trigger={content} /> : content;\r\n};\r\nconst Header = ({\r\n  id,\r\n  name,\r\n  lastUpdated,\r\n  upCount,\r\n  readCount,\r\n  followerCount,\r\n  totalUsedCount,\r\n  currentUpped,\r\n  currentFollowed,\r\n  refetchProgram,\r\n  programVersion\r\n}) => {\r\n  return (\r\n    <Container>\r\n      <Name>\r\n        {name}\r\n        {programVersion && programVersion.status !== \"Published\" && (\r\n          <TestHint>【测试：{programVersion.versionCode}】</TestHint>\r\n        )}\r\n      </Name>\r\n      <InfoBox>\r\n        <InfoItem\r\n          hintText={\"最近更新日期\"}\r\n          icon={\"calendar alternate outline\"}\r\n          text={lastUpdated}\r\n        />\r\n        <ClickWrapper\r\n          gql={SWITCH_FOLLOW}\r\n          variables={{ objId: id, objType: OBJ_TYPES.PROGRAM }}\r\n          onCompleted={() => refetchProgram()}\r\n        >\r\n          <InfoItem\r\n            iconStyle={{ color: currentFollowed ? \"#F76976\" : \"\" }}\r\n            hintText={currentFollowed ? \"取消收藏\" : \"收藏\"}\r\n            icon={\"star outline\"}\r\n            text={followerCount}\r\n          />\r\n        </ClickWrapper>\r\n        <ClickWrapper\r\n          gql={SWITCH_UP}\r\n          variables={{ objId: id, objType: OBJ_TYPES.PROGRAM }}\r\n          onCompleted={() => refetchProgram()}\r\n        >\r\n          <InfoItem\r\n            iconStyle={{ color: currentUpped ? \"#F76976\" : \"\" }}\r\n            hintText={currentUpped ? \"取消喜欢\" : \"点击喜欢\"}\r\n            icon={\"heart outline\"}\r\n            text={upCount}\r\n          />\r\n        </ClickWrapper>\r\n        <Space width={20} />\r\n        <InfoItem\r\n          hintText={\"浏览次数\"}\r\n          icon={\"eye\"}\r\n          text={Number(readCount) + 1}\r\n        />\r\n        {/*<Space width={20} />*/}\r\n        {/*<InfoItem hintText={\"使用次数\"} icon={\"eye\"} text={totalUsedCount} />*/}\r\n      </InfoBox>\r\n    </Container>\r\n  );\r\n};\r\n\r\nexport default Header;\r\n","import React, { useState, useEffect } from \"react\";\r\nimport styled from \"styled-components\";\r\n\r\nconst Container = styled.div`\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  background-color: grey;\r\n  width: 100%;\r\n  height: 100%;\r\n  min-height: 600px;\r\n`;\r\n\r\nconst HintText = styled.div``;\r\n\r\nconst ProgramEmpty = () => {\r\n  return (\r\n    <Container>\r\n      <HintText>抱歉，该工具暂未实现！</HintText>\r\n    </Container>\r\n  );\r\n};\r\n\r\nexport default ProgramEmpty;\r\n","import React, { useState, useEffect } from \"react\";\r\nimport styled from \"styled-components\";\r\nimport _pick from \"lodash/pick\";\r\nimport _get from \"lodash/get\";\r\nimport { getDataFromUrl } from \"../../../utils/urlData\";\r\nimport Loading from \"../../../common/Loading\";\r\nimport {\r\n  useIframeLoading,\r\n  useMe,\r\n  useResizeIframe\r\n} from \"../../../common/hooks\";\r\nimport { SERVER_URL } from \"../../../../config\";\r\n\r\nconst Container = styled.div`\r\n  width: 100%;\r\n  height: ${props => props.height}px;\r\n  justify-content: center;\r\n  align-items: center;\r\n`;\r\n\r\nconst IFrame = styled.iframe`\r\n  width: ${props => props.width}px;\r\n  height: ${props => props.height}px;\r\n  border: medium none;\r\n`;\r\n\r\nconst JsProgram = ({\r\n  code,\r\n  programUrl,\r\n  programId,\r\n  programName,\r\n  currentUser,\r\n  versionId,\r\n  importType\r\n}) => {\r\n  const { loading } = useIframeLoading();\r\n  const { width, height } = useResizeIframe();\r\n  // useEffect(() => {\r\n  //   const messageHandler = event => {\r\n  //     const {\r\n  //       data: { hello }\r\n  //     } = event;\r\n  //     if (hello === \"hello\") {\r\n  //       window.sayOK(hello);\r\n  //     }\r\n  //   };\r\n  //\r\n  //   const programIframe = document.getElementById(\"program_iframe\");\r\n  //   //  todo 跨域问题，发布时修正\r\n  //   programIframe.contentWindow.postMessage({ lazyWindow: 12222 }, \"*\");\r\n  //   window.addEventListener(\"message\", messageHandler);\r\n  //   return () => window.removeEventListener(\"message\", messageHandler);\r\n  // }, []);\r\n  const currentUserStr = JSON.stringify({\r\n    ..._pick(currentUser, [\"id\", \"username\", \"nickname\", \"phone\", \"email\"]),\r\n    avatar: _get(currentUser, \"avatar.url\")\r\n  });\r\n  return (\r\n    <Container height={height}>\r\n      {loading && <Loading hasMask={true}>加载中...</Loading>}\r\n      <IFrame\r\n        id={\"program_iframe\"}\r\n        src={`${SERVER_URL}/programs?programId=${programId}&programName=${programName}&importType=${importType}&token=${\r\n          currentUser.access_token\r\n        }&programCode=${code}&programJsUrl=${encodeURIComponent(\r\n          programUrl\r\n        )}&currentUser=${encodeURIComponent(\r\n          currentUserStr\r\n        )}&versionId=${versionId}`}\r\n        width={width}\r\n        height={height}\r\n      />\r\n    </Container>\r\n  );\r\n};\r\n\r\nexport default JsProgram;\r\n","import React, { useState, useEffect } from \"react\";\r\nimport styled from \"styled-components\";\r\nimport _pick from \"lodash/pick\";\r\nimport _get from \"lodash/get\";\r\nimport { SERVER_URL } from \"../../../../config\";\r\nimport { useIframeLoading } from \"../../../common/hooks\";\r\nimport Loading from \"../../../common/Loading\";\r\n\r\nconst Container = styled.div`\r\n  width: 100%;\r\n  min-height: 600px;\r\n  justify-content: center;\r\n  align-items: center;\r\n  position: relative;\r\n`;\r\n\r\nconst IFrame = styled.iframe`\r\n  width: 100%;\r\n  min-height: 600px;\r\n  border: medium none;\r\n`;\r\n\r\nconst HtmlProgram = ({\r\n  code,\r\n  programUrl,\r\n  programId,\r\n  programName,\r\n  currentUser,\r\n  versionId,\r\n  importType\r\n}) => {\r\n  const { loading } = useIframeLoading();\r\n  const currentUserStr = JSON.stringify({\r\n    ..._pick(currentUser, [\"id\", \"username\", \"nickname\", \"phone\", \"email\"]),\r\n    avatar: _get(currentUser, \"avatar.url\")\r\n  });\r\n  return (\r\n    <Container>\r\n      {loading && <Loading hasMask={true}>加载中...</Loading>}\r\n      <IFrame\r\n        id={\"program_iframe\"}\r\n        src={`${SERVER_URL}/programs?programId=${programId}&programName=${programName}&importType=${importType}&token=${\r\n          currentUser.access_token\r\n        }&programCode=${code}&programJsUrl=${encodeURIComponent(\r\n          programUrl\r\n        )}&currentUser=${encodeURIComponent(\r\n          currentUserStr\r\n        )}&versionId=${versionId}`}\r\n        width=\"600\"\r\n        height=\"400\"\r\n      />\r\n    </Container>\r\n  );\r\n};\r\n\r\nexport default HtmlProgram;\r\n","import React, { useState, useEffect } from \"react\";\r\nimport styled from \"styled-components\";\r\nimport ProgramEmpty from \"./ProgramEmpty\";\r\nimport JsProgram from \"./JsProgram\";\r\nimport HtmlProgram from \"./HtmlProgram\";\r\n\r\nconst Container = styled.div`\r\n  width: 100%;\r\n  background-color: #f2f2f2;\r\n`;\r\n\r\nconst getProgramByImportType = ({\r\n  importType,\r\n  programUrl,\r\n  code,\r\n  id,\r\n  name,\r\n  currentUser,\r\n  versionId\r\n}) => {\r\n  switch (importType) {\r\n    case \"OnlyJs\":\r\n      return (\r\n        <JsProgram\r\n          code={code}\r\n          programUrl={programUrl}\r\n          programId={id}\r\n          currentUser={currentUser}\r\n          programName={name}\r\n          importType={importType}\r\n          versionId={versionId}\r\n        />\r\n      );\r\n    case \"OnlyHtml\":\r\n      return (\r\n        <HtmlProgram\r\n          code={code}\r\n          programUrl={programUrl}\r\n          programId={id}\r\n          currentUser={currentUser}\r\n          programName={name}\r\n          importType={importType}\r\n          versionId={versionId}\r\n        />\r\n      );\r\n    default:\r\n      return <ProgramEmpty />;\r\n  }\r\n};\r\n\r\nconst ProgramWindow = ({ program, currentUser, programVersion }) => {\r\n  const { code, currentVersion, id, name } = program;\r\n  if (!currentVersion) {\r\n    return <ProgramEmpty />;\r\n  }\r\n  const {\r\n    id: versionId,\r\n    importType,\r\n    codeFile: { url: codeUrl }\r\n  } = programVersion || currentVersion;\r\n  const programComponent = getProgramByImportType({\r\n    importType,\r\n    programUrl: codeUrl,\r\n    code,\r\n    id,\r\n    name,\r\n    currentUser,\r\n    versionId\r\n  });\r\n\r\n  return <Container>{programComponent}</Container>;\r\n};\r\n\r\nexport default ProgramWindow;\r\n","import React from \"react\";\r\nimport styled from \"styled-components\";\r\nimport { Icon } from \"semantic-ui-react\";\r\nimport { MAIN_RED } from \"./Styles\";\r\nimport ReportButton from \"./ReportButton\";\r\n\r\nconst Container = styled.div`\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  width: 50px;\r\n  height: 50px;\r\n  border-radius: 25px;\r\n  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.6);\r\n  cursor: pointer;\r\n  text-align: center;\r\n  &:hover {\r\n    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);\r\n    color: ${MAIN_RED};\r\n  }\r\n`;\r\n\r\nconst ReportAction = ({\r\n  type,\r\n  objId,\r\n  title,\r\n  currentReport,\r\n  reportCallback\r\n}) => {\r\n  return (\r\n    <Container>\r\n      <ReportButton\r\n        type={type}\r\n        title={title}\r\n        objId={objId}\r\n        reportCallback={reportCallback}\r\n      >\r\n        <Icon\r\n          style={{ color: currentReport ? MAIN_RED : \"\" }}\r\n          name={currentReport ? \"flag\" : \"flag outline\"}\r\n          size={\"large\"}\r\n        />\r\n      </ReportButton>\r\n    </Container>\r\n  );\r\n};\r\n\r\nexport default ReportAction;\r\n","import React from \"react\";\r\nimport styled from \"styled-components\";\r\nimport { MAIN_RED } from \"./Styles\";\r\nimport { Tooltip } from \"antd\";\r\nimport { Rating as StarRating, Rating } from \"semantic-ui-react\";\r\nimport { useRating } from \"./hooks\";\r\nimport _get from \"lodash/get\";\r\n\r\nconst Container = styled.div`\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  width: 60px;\r\n  height: 60px;\r\n  border-radius: 30px;\r\n  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.6);\r\n  cursor: pointer;\r\n  text-align: center;\r\n  &:hover {\r\n    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);\r\n    color: ${MAIN_RED};\r\n    .rating {\r\n      display: block;\r\n    }\r\n  }\r\n  position: relative;\r\n`;\r\n\r\nconst Btn = styled(Tooltip)`\r\n  width: 60px;\r\n  height: 60px;\r\n  border-radius: 30px;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n`;\r\n\r\nconst RatingScore = styled.div`\r\n  font-size: 26px;\r\n  color: gold;\r\n  font-weight: bold;\r\n`;\r\n\r\nconst RatingBox = styled.div`\r\n  display: none;\r\n  position: absolute;\r\n  right: -160px;\r\n  width: 200px;\r\n`;\r\n\r\nconst RatingAction = ({\r\n  averageScore,\r\n  currentRating,\r\n  objId,\r\n  objType,\r\n  onRateCompleted\r\n}) => {\r\n  const { rating, mLoading, onRate } = useRating({\r\n    currentRating,\r\n    objType: objType,\r\n    objId: objId,\r\n    onRateCompleted\r\n  });\r\n  return (\r\n    <Container>\r\n      <Btn title={currentRating ? \"已评分\" : \"评分\"}>\r\n        <RatingScore>\r\n          {Number(rating.averageScore || averageScore).toFixed(1)}\r\n        </RatingScore>\r\n      </Btn>\r\n      <RatingBox className={\"rating\"}>\r\n        <Rating\r\n          onRate={(e, { rating }) => onRate(rating)}\r\n          rating={_get(rating, \"score\", 0)}\r\n          maxRating={5}\r\n          icon={\"star\"}\r\n          size={\"large\"}\r\n        />\r\n      </RatingBox>\r\n    </Container>\r\n  );\r\n};\r\n\r\nexport default RatingAction;\r\n","import React from \"react\";\r\nimport styled from \"styled-components\";\r\nimport { MAIN_RED } from \"./Styles\";\r\nimport { Tooltip } from \"antd\";\r\nimport _map from \"lodash/map\";\r\nimport { Label } from \"semantic-ui-react\";\r\nimport _get from \"lodash/get\";\r\n\r\nconst Container = styled.div`\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  width: 60px;\r\n  height: 60px;\r\n  border-radius: 30px;\r\n  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.6);\r\n  cursor: pointer;\r\n  text-align: center;\r\n  .tooltip {\r\n    &:hover {\r\n      .git_box {\r\n        display: flex;\r\n        flex-direction: column;\r\n      }\r\n    }\r\n  }\r\n  &:hover {\r\n    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);\r\n    color: ${MAIN_RED};\r\n    .git_box {\r\n      display: flex;\r\n      flex-direction: column;\r\n    }\r\n  }\r\n  position: relative;\r\n`;\r\n\r\nconst Btn = styled(Tooltip)`\r\n  width: 60px;\r\n  height: 60px;\r\n  border-radius: 30px;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n`;\r\n\r\nconst GitIcon = styled.img`\r\n  width: 100%;\r\n  height: 100%;\r\n`;\r\n\r\nconst GitBox = styled.div`\r\n  display: none;\r\n  position: absolute;\r\n  left: 60px;\r\n  font-size: 16px;\r\n  width: 400px;\r\n  color: darkgray;\r\n`;\r\n\r\nconst GitItemBox = styled.div`\r\n  display: flex;\r\n  align-items: center;\r\n  margin-bottom: 2px;\r\n  text-align: left;\r\n  background-color: #e8e8e8;\r\n  border-radius: 10px;\r\n  padding: 4px 6px;\r\n`;\r\n\r\nconst GitLink = styled.a`\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n  white-space: nowrap;\r\n  color: black;\r\n  text-align: left;\r\n  background-color: white;\r\n  padding: 2px 4px;\r\n  width: 100%;\r\n  display: block;\r\n  &:hover {\r\n    color: red !important;\r\n  }\r\n`;\r\n\r\nconst TypeNameBox = styled.div`\r\n  width: 100px;\r\n`;\r\n\r\nconst GitItem = ({ linkUrl, typeName }) => {\r\n  return (\r\n    <GitItemBox>\r\n      <TypeNameBox>{typeName}:</TypeNameBox>\r\n\r\n      <GitLink href={linkUrl} target={\"_blank\"}>\r\n        {linkUrl}\r\n        {/*<Tooltip className={\"tooltip\"} title={linkUrl}>{linkUrl}</Tooltip>*/}\r\n      </GitLink>\r\n    </GitItemBox>\r\n  );\r\n};\r\n\r\nconst GitAction = ({ gitLinks }) => {\r\n  return (\r\n    <Container>\r\n      <Btn title={\"git链接\"}>\r\n        <GitIcon\r\n          src={\r\n            \"https://lazychunstatic.oss-cn-shanghai.aliyuncs.com/util_files/planet/icons/git_icon.png\"\r\n          }\r\n        />\r\n      </Btn>\r\n      <GitBox className={\"git_box\"}>\r\n        {_map(gitLinks, g => {\r\n          return (\r\n            <GitItem key={g.id} linkUrl={g.linkUrl} typeName={g.gitType.name} />\r\n          );\r\n        })}\r\n      </GitBox>\r\n    </Container>\r\n  );\r\n};\r\n\r\nexport default GitAction;\r\n","import React, { useState } from \"react\";\r\nimport styled from \"styled-components\";\r\nimport { Icon } from \"semantic-ui-react\";\r\nimport { MAIN_RED } from \"./Styles\";\r\nimport { Tooltip, Drawer } from \"antd\";\r\n\r\nconst Container = styled.div`\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  width: 50px;\r\n  height: 50px;\r\n  border-radius: 25px;\r\n  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.6);\r\n  cursor: pointer;\r\n  text-align: center;\r\n  &:hover {\r\n    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);\r\n    color: ${MAIN_RED};\r\n  }\r\n`;\r\n\r\nconst Btn = styled(Tooltip)`\r\n  width: 50px;\r\n  height: 50px;\r\n  border-radius: 25px;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n`;\r\n\r\nconst HelpAction = ({ onShowSwitch }) => {\r\n  return (\r\n    <Container>\r\n      <Btn onClick={() => onShowSwitch()} title={\"点击查看帮助\"}>\r\n        <Icon name={\"help\"} size={\"big\"} />\r\n      </Btn>\r\n    </Container>\r\n  );\r\n};\r\n\r\nexport default HelpAction;\r\n","import React from \"react\";\r\nimport styled from \"styled-components\";\r\nimport ReportAction from \"./ReportAction\";\r\nimport RatingAction from \"./RatingAction\";\r\nimport Space from \"./Space\";\r\nimport GitAction from \"./GitAction\";\r\nimport _isEmpty from \"lodash/isEmpty\";\r\nimport HelpAction from \"./HelpAction\";\r\n\r\nconst Container = styled.div`\r\n  display: flex;\r\n  align-items: center;\r\n  flex-direction: column;\r\n  position: absolute;\r\n  top: 0px;\r\n  right: -120px;\r\n`;\r\n\r\nconst FloatActions = ({\r\n  objId,\r\n  type,\r\n  reportProps: { currentReport, title, reportCallback },\r\n  ratingProps: { averageScore, currentRating, onRateCompleted },\r\n  helpProps: { helpVideo, helpDescription, onShowSwitch },\r\n  gitProps: { gitLinks }\r\n}) => {\r\n  return (\r\n    <Container>\r\n      <RatingAction\r\n        averageScore={averageScore}\r\n        currentRating={currentRating}\r\n        objId={objId}\r\n        objType={type}\r\n        onRateCompleted={onRateCompleted}\r\n      />\r\n      <Space height={\"30px\"} />\r\n      {!_isEmpty(gitLinks) && (\r\n        <>\r\n          <GitAction gitLinks={gitLinks} />\r\n          <Space height={\"30px\"} />\r\n        </>\r\n      )}\r\n      <ReportAction\r\n        currentReport={currentReport}\r\n        title={title}\r\n        objId={objId}\r\n        type={type}\r\n        reportCallback={reportCallback}\r\n      />\r\n      {(helpVideo || helpDescription) && (\r\n        <>\r\n          <Space height={\"30px\"} />\r\n          <HelpAction\r\n            helpVideo={helpVideo}\r\n            helpDescription={helpDescription}\r\n            onShowSwitch={onShowSwitch}\r\n          />\r\n        </>\r\n      )}\r\n    </Container>\r\n  );\r\n};\r\n\r\nexport default FloatActions;\r\n","import React, { useState, useEffect } from \"react\";\r\nimport { useMutation, useQuery } from \"@apollo/react-hooks\";\r\nimport { GET_PROGRAM_DATA_LIST } from \"./queryGql\";\r\nimport { SAVE_PROGRAM_DATA } from \"./mutationGql\";\r\n\r\nconst STORE_TYPES = {\r\n  SAVE: \"save\",\r\n  FIND: \"find\",\r\n  FIND_ALL: \"findAll\"\r\n};\r\n\r\nconst getStoreFncName = (type, programCode) => {\r\n  return `__$${type}_${programCode}$__`;\r\n};\r\n\r\nconst useServerStore = ({ program }) => {\r\n  const { loading, error, data, refetch } = useQuery(GET_PROGRAM_DATA_LIST, {\r\n    skip: true\r\n  });\r\n  const [saveData, { data: saveResult, loading: mLoading }] = useMutation(\r\n    SAVE_PROGRAM_DATA,\r\n    {\r\n      onCompleted: () => {},\r\n      onError: () => {}\r\n    }\r\n  );\r\n  useEffect(() => {\r\n    const onSave = params => {\r\n      return saveData({\r\n        variables: {\r\n          programId: program.id,\r\n          uniqueId: params.id,\r\n          type: params.type,\r\n          isLarge: params.isLarge,\r\n          isOpened: params.isOpened,\r\n          data: params.data\r\n        }\r\n      });\r\n    };\r\n    const onSearchDataList = params =>\r\n      refetch({\r\n        variables: {\r\n          programId: program.id,\r\n          limit: params.limit,\r\n          offset: params.offset,\r\n          sort: params.sort,\r\n          order: params.order,\r\n          types: params.types,\r\n          statuses: [\"Published\"],\r\n          dateCreated: params.dateCreated,\r\n          lastUpdated: params.lastUpdated\r\n        }\r\n      });\r\n    const serverStore = {\r\n      [getStoreFncName(STORE_TYPES.SAVE, program.code)]: ({\r\n        id,\r\n        type,\r\n        isLarge,\r\n        data,\r\n        isOpened\r\n      }) => {\r\n        return new Promise((resolve, reject) => {\r\n          const dataText =\r\n            typeof data === \"string\" ? data : JSON.stringify(data);\r\n          onSave({ id, type, isLarge, data: dataText, isOpened }).then(res => {\r\n            console.log(\"res__________________\", res);\r\n            resolve(res);\r\n          });\r\n        });\r\n      }\r\n    };\r\n    console.log(\"serverStore______________________\", serverStore);\r\n    window.serverStore = serverStore;\r\n  }, []);\r\n};\r\n\r\nconst ServerStore = ({ children, program }) => {\r\n  useServerStore({ program });\r\n  return <>{children}</>;\r\n};\r\n\r\nexport default ServerStore;\r\n","import React, { useEffect, useState } from \"react\";\r\nimport styled from \"styled-components\";\r\nimport Video from \"../../blog/BlogSegaments/Video\";\r\nimport { getDataFromUrl } from \"../../../utils/urlData\";\r\n\r\nconst Container = styled.div``;\r\n\r\nconst VideoBox = styled.div``;\r\n\r\nconst Description = styled.div`\r\n  text-align: left;\r\n  margin-top: 30px;\r\n`;\r\n\r\nconst HelpPanel = ({ helpVideo, helpDescription }) => {\r\n  const [description, setDescription] = useState(\"\");\r\n  useEffect(() => {\r\n    getDataFromUrl(helpDescription, \"data.content\", str => setDescription(str));\r\n  }, [helpDescription]);\r\n  return (\r\n    <Container>\r\n      <VideoBox>\r\n        {helpVideo && <Video contentUrl={helpVideo} isContent={false} />}\r\n      </VideoBox>\r\n      {helpDescription && (\r\n        <Description dangerouslySetInnerHTML={{ __html: description }} />\r\n      )}\r\n    </Container>\r\n  );\r\n};\r\n\r\nexport default HelpPanel;\r\n","import React, { useState, useEffect } from \"react\";\r\nimport styled from \"styled-components\";\r\nimport PageItem from \"../QueryItem\";\r\nimport { getRouteId } from \"../../utils/routeUtils\";\r\nimport { GET_PROGRAM, GET_PROGRAM_WITH_VERSION } from \"../../common/queryGql\";\r\nimport Header from \"./programSegaments/Header\";\r\nimport ProgramWindow from \"./programSegaments/ProgramWindow\";\r\nimport Description from \"./programSegaments/Description\";\r\nimport Comments from \"../../common/comment/Comments\";\r\nimport { OBJ_TYPES } from \"../../common/CONSULT\";\r\nimport { useRead } from \"../../common/hooks\";\r\nimport CurrentObjLoader from \"../../common/CurrentObjLoader\";\r\nimport FloatActions from \"../../common/FloatActions\";\r\nimport ServerStore from \"../../common/ServerStore\";\r\nimport { useParams } from \"react-router-dom\";\r\nimport PageTitle from \"../../common/PageTitle\";\r\nimport { Drawer } from \"antd\";\r\nimport HelpPanel from \"./programSegaments/HelpPanel\";\r\n\r\nconst ProgramBox = styled.div`\r\n  width: 100%;\r\n  position: relative;\r\n`;\r\n\r\nconst _Program = ({\r\n  program,\r\n  refetchProgram,\r\n  currentUser,\r\n  programVersion,\r\n  onShowSwitch\r\n}) => {\r\n  useRead({ objId: program.id, objType: OBJ_TYPES.PROGRAM });\r\n  return (\r\n    <ServerStore program={program}>\r\n      <PageTitle title={`${program.name}`} metaKeywords={`${program.name}`} />\r\n      <CurrentObjLoader openedObj={program}>\r\n        <ProgramBox>\r\n          <FloatActions\r\n            type={OBJ_TYPES.PROGRAM}\r\n            objId={program.id}\r\n            reportProps={{\r\n              currentReport: program.currentReport,\r\n              title: `举报工具${program.name}`,\r\n              reportCallback: () => {\r\n                console.log(\"refetchProgram_____________\", refetchProgram);\r\n                refetchProgram && refetchProgram();\r\n              }\r\n            }}\r\n            ratingProps={{\r\n              currentRating: program.currentRating,\r\n              averageScore: program.averageScore,\r\n              onRateCompleted: () => {\r\n                refetchProgram && refetchProgram();\r\n              }\r\n            }}\r\n            helpProps={{\r\n              helpVideo: program.helpVideo,\r\n              helpDescription: program.helpDescription,\r\n              onShowSwitch\r\n            }}\r\n            gitProps={{ gitLinks: program.gitLinks }}\r\n          />\r\n          <Header\r\n            {...program}\r\n            programVersion={programVersion}\r\n            refetchProgram={refetchProgram}\r\n          />\r\n          <ProgramWindow\r\n            program={program}\r\n            programVersion={programVersion}\r\n            currentUser={currentUser}\r\n          />\r\n          <Description descriptionUrl={program.descriptionUrl} />\r\n          <Comments type={OBJ_TYPES.PROGRAM} objId={program.id} />\r\n        </ProgramBox>\r\n      </CurrentObjLoader>\r\n    </ServerStore>\r\n  );\r\n};\r\n\r\nconst Container = styled.div`\r\n  width: 1300px;\r\n  margin-top: 18px;\r\n`;\r\n\r\nconst getQueryGql = version => {\r\n  if (!version) {\r\n    return GET_PROGRAM;\r\n  }\r\n  return GET_PROGRAM_WITH_VERSION;\r\n};\r\n\r\nconst HelpTitle = styled.div`\r\n  text-align: left;\r\n`;\r\n\r\nconst Program = ({ history, location, currentUser }) => {\r\n  const { id, version } = useParams();\r\n  const [showHelp, setShowHelp] = useState(false);\r\n  return (\r\n    <Container>\r\n      <PageItem\r\n        autoLoading\r\n        id={id}\r\n        variables={{ version }}\r\n        gql={getQueryGql(version)}\r\n      >\r\n        {({ loading, refetch, item }) => {\r\n          const program = item.program;\r\n          const programVersion = item.programVersion;\r\n          return (\r\n            <>\r\n              <_Program\r\n                program={program}\r\n                programVersion={programVersion}\r\n                refetchProgram={refetch}\r\n                currentUser={currentUser}\r\n                setShowHelp={setShowHelp}\r\n                onShowSwitch={() => setShowHelp(!showHelp)}\r\n              />\r\n              <Drawer\r\n                title={<HelpTitle>帮助</HelpTitle>}\r\n                placement=\"right\"\r\n                closable={true}\r\n                onClose={() => setShowHelp(false)}\r\n                visible={showHelp}\r\n                width={1200}\r\n                getContainer={false}\r\n                style={{ position: \"absolute\" }}\r\n              >\r\n                <HelpPanel\r\n                  helpVideo={program.helpVideo}\r\n                  helpDescription={program.helpDescription}\r\n                />\r\n              </Drawer>\r\n            </>\r\n          );\r\n        }}\r\n      </PageItem>\r\n    </Container>\r\n  );\r\n};\r\n\r\nexport default Program;\r\n","export const MAIN_RED = \"#f02737\";","import React, { useEffect } from \"react\";\r\nimport { AppContext } from \"../../App\";\r\n\r\nconst _CurrentObjLoader = ({ children, setOpenedObj, openedObj }) => {\r\n  useEffect(() => {\r\n    if (setOpenedObj) {\r\n      setOpenedObj(openedObj);\r\n    }\r\n    return () => setOpenedObj(null);\r\n  }, [openedObj]);\r\n  return <>{children}</>;\r\n};\r\n\r\nconst CurrentObjLoader = ({ openedObj, children }) => {\r\n  return (\r\n    <AppContext.Consumer>\r\n      {props => {\r\n        const { onGoTo, setOpenedObj } = props;\r\n        return (\r\n          <_CurrentObjLoader\r\n            setOpenedObj={setOpenedObj}\r\n            openedObj={openedObj}\r\n            children={children}\r\n          />\r\n        );\r\n      }}\r\n    </AppContext.Consumer>\r\n  );\r\n};\r\n\r\nexport default CurrentObjLoader;\r\n"],"sourceRoot":""}